flowchart LR
    subgraph Client
        PIN[User PIN]
        KDF[Key Derivation]
        EK[Encryption Key]
        PIN --> KDF --> EK
    end

    subgraph Encryption
        DATA[User Data]
        ENC[AES-256-GCM Encrypt]
        CIPHER[Ciphertext]
        DATA --> ENC
        EK --> ENC
        ENC --> CIPHER
    end

    subgraph Server
        STORE[(Encrypted Storage)]
        RELAY[Relay Only]
        CIPHER --> STORE
        STORE --> RELAY
    end

    subgraph Decryption
        CIPHER2[Ciphertext]
        DEC[AES-256-GCM Decrypt]
        PLAIN[Plaintext Data]
        RELAY --> CIPHER2
        CIPHER2 --> DEC
        EK -.-> DEC
        DEC --> PLAIN
    end
