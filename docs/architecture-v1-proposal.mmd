graph TD
    subgraph Clients [Clients]
        TelegramApp[Telegram]
        MobileApp[Mobile]
        CLI[CLI]
    end

    subgraph Worker [Worker]
        TelegramBot[Telegram Bot]
        HTTPServer[HTTP Server]
        KoroMind[KoroMind Core<br/>thin orchestration]
        ClaudeSDK[Claude SDK<br/>does the heavy lifting]
        ElevenLabs[ElevenLabs]

        TelegramBot --> KoroMind
        HTTPServer --> KoroMind
        KoroMind -->|"passes config"| ClaudeSDK
        KoroMind --> ElevenLabs
    end

    subgraph Backup [Backup - External]
        Snapshots[Volume Snapshots]
        ExternalStorage[External Storage]
    end

    subgraph Vault [Vault - User State & Config]
        DotClaude[.claude]
        SQLiteDB[SQLite DB]
        GitRepos[Git Repos]
        SecondBrain[Second Brain]
        MCPConfig[MCP Servers Config]
        AgentsConfig[Agent Definitions]
        HooksConfig[Hooks Config]
        PermsConfig[Permission Rules]
    end

    subgraph Sandbox [Sandbox]
        direction LR
        WorkingFiles[Working Files]
        CodeExecution[Code Execution]
        TempArtifacts[Temp Artifacts]
    end

    %% Client connections
    TelegramApp --> TelegramBot
    MobileApp --> HTTPServer
    CLI --> HTTPServer

    %% Layout hints - Backup above Vault
    Backup --> Vault

    %% Worker connections
    KoroMind -.->|"loads config"| Vault
    ClaudeSDK <-->|"read/write/execute"| Sandbox
    ClaudeSDK -->|"manages"| MCPConfig
    Sandbox -->|"sync/commit"| Vault
